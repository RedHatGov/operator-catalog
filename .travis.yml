---
dist: bionic
language: python
services:
- docker
install:
- pip3 install -r requirements.txt
script:
# Don't even accidentally build a copy without appending -dev
- ./operator-index.py build -vvvv --tag-extension dev
deploy:
- provider: script
  script: docker login -u "$QUAY_USERNAME" -p "$QUAY_PASSWORD" quay.io && ./operator-index.py push -vvvv --tag-extension dev --extra-tag develop && ./operator-index.py push -vvvv --testing
  on:
    branch: develop
- provider: script
  script: docker login -u "$QUAY_USERNAME" -p "$QUAY_PASSWORD" quay.io && ./operator-index.py push -vvvv --extra-tag latest --build
  on:
    branch: main
